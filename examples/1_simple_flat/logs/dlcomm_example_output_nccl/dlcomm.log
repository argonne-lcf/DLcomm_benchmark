2025-08-20 17:39:20.709 - DL_COMM - INFO - -------------------------------------------------------------------------
2025-08-20 17:39:20.711 - DL_COMM - INFO - [CONFIG] Loading schema and validating user YAML
2025-08-20 17:39:20.711 - DL_COMM - INFO - [DEBUG] Current working directory: /lus/eagle/projects/datascience_collab/mcim/workspace/DLcomm_benchmark
2025-08-20 17:39:20.711 - DL_COMM - INFO - [DEBUG] Script location: /lus/eagle/projects/datascience_collab/mcim/workspace/DLcomm_benchmark/dl_comm
2025-08-20 17:39:20.711 - DL_COMM - INFO - [DEBUG] Tasks to run: ['simple-allreduce']
2025-08-20 17:39:20.711 - DL_COMM - INFO - [DEBUG] Config loaded successfully
2025-08-20 17:39:22.466 - DL_COMM - INFO - 
2025-08-20 17:39:22.467 - DL_COMM - INFO - [SYSTEM] Collecting environment information...
2025-08-20 17:39:22.467 - DL_COMM - INFO - [SYSTEM] ======================================================
2025-08-20 17:39:22.467 - DL_COMM - INFO - [SYSTEM] PyTorch version: 2.3.0
2025-08-20 17:39:22.467 - DL_COMM - INFO - [SYSTEM] Is CUDA available: True
2025-08-20 17:39:22.467 - DL_COMM - INFO - [SYSTEM] CUDA used to build PyTorch: 12.4
2025-08-20 17:39:22.467 - DL_COMM - INFO - [SYSTEM] GPU models and configuration:
2025-08-20 17:39:22.532 - DL_COMM - INFO - [SYSTEM] GPU 0: NVIDIA A100-SXM4-40GB (39.4 GB)
2025-08-20 17:39:22.532 - DL_COMM - INFO - [SYSTEM] GPU 1: NVIDIA A100-SXM4-40GB (39.4 GB)
2025-08-20 17:39:22.532 - DL_COMM - INFO - [SYSTEM] GPU 2: NVIDIA A100-SXM4-40GB (39.4 GB)
2025-08-20 17:39:22.532 - DL_COMM - INFO - [SYSTEM] GPU 3: NVIDIA A100-SXM4-40GB (39.4 GB)
2025-08-20 17:39:22.532 - DL_COMM - INFO - 
2025-08-20 17:39:22.537 - DL_COMM - INFO - [SYSTEM] OS: Linux-5.14.21-150500.55.49-default-x86_64-with-glibc2.31
2025-08-20 17:39:22.541 - DL_COMM - INFO - [SYSTEM] GCC version: gcc (SUSE Linux) 7.5.0
2025-08-20 17:39:22.541 - DL_COMM - INFO - 
2025-08-20 17:39:22.541 - DL_COMM - INFO - [SYSTEM] Python version: 3.11.8 | packaged by conda-forge | (main, Feb 16 2024, 20:53:32) [GCC 12.3.0]
2025-08-20 17:39:22.542 - DL_COMM - INFO - [SYSTEM] Python platform: Linux-5.14.21-150500.55.49-default-x86_64-with-glibc2.31
2025-08-20 17:39:22.542 - DL_COMM - INFO - 
2025-08-20 17:39:22.542 - DL_COMM - INFO - [SYSTEM] Distributed Backend Availability:
2025-08-20 17:39:22.542 - DL_COMM - INFO - [SYSTEM] NCCL backend available: True
2025-08-20 17:39:22.542 - DL_COMM - INFO - [SYSTEM] MPI backend available: True
2025-08-20 17:39:22.542 - DL_COMM - INFO - [SYSTEM] XCCL backend available: Unknown/Error
2025-08-20 17:39:22.542 - DL_COMM - INFO - 
2025-08-20 17:39:22.542 - DL_COMM - INFO - [SYSTEM] Versions of relevant libraries:
2025-08-20 17:39:22.542 - DL_COMM - INFO - [SYSTEM] numpy: 1.26.4
2025-08-20 17:39:22.542 - DL_COMM - INFO - [SYSTEM] mpi4py: 3.1.6
2025-08-20 17:39:22.542 - DL_COMM - INFO - [SYSTEM] hydra-core: 1.3.2
2025-08-20 17:39:22.542 - DL_COMM - INFO - [SYSTEM] omegaconf: 2.3.0
2025-08-20 17:39:22.543 - DL_COMM - INFO - [SYSTEM] oneccl_bindings_for_pytorch: Not available
2025-08-20 17:39:22.543 - DL_COMM - INFO - [SYSTEM] intel_extension_for_pytorch: Not available
2025-08-20 17:39:22.543 - DL_COMM - INFO - [SYSTEM] NCCL version: 2.20.5
2025-08-20 17:39:22.543 - DL_COMM - INFO - 
2025-08-20 17:39:22.543 - DL_COMM - INFO - [SYSTEM] Relevant Environment Variables:
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CCL_ATL_SHM                    = 1
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CCL_ATL_TRANSPORT              = ofi
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CCL_ENABLE_AUTO_CACHE          = 1
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CCL_ENABLE_PROFILING           = 1
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CCL_KVS_CONNECTION_TIMEOUT     = 600
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CCL_KVS_MODE                   = mpi
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CCL_LOG_LEVEL                  = info
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CCL_OP_SYNC                    = 1
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CCL_PROCESS_LAUNCHER           = pmix
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CUDA_HOME                      = /soft/compilers/cudatoolkit/cuda-12.4.1/
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CUDA_MODULE_LOADING            = LAZY
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CUDA_PATH                      = /soft/compilers/cudatoolkit/cuda-12.4.1/
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] CUDA_TOOLKIT_BASE              = /soft/compilers/cudatoolkit/cuda-12.4.1/
2025-08-20 17:39:22.544 - DL_COMM - INFO - [SYSTEM] MASTER_ADDR                    = x3005c0s37b0n0
2025-08-20 17:39:22.545 - DL_COMM - INFO - [SYSTEM] MASTER_PORT                    = 2268
2025-08-20 17:39:22.545 - DL_COMM - INFO - [SYSTEM] MPI4JAX_USE_CUDA_MPI           = 1
2025-08-20 17:39:22.545 - DL_COMM - INFO - [SYSTEM] PALS_LOCAL_RANKID              = 0
2025-08-20 17:39:22.545 - DL_COMM - INFO - [SYSTEM] PALS_RANKID                    = 0
2025-08-20 17:39:22.545 - DL_COMM - INFO - [SYSTEM] PMI_LOCAL_RANK                 = 0
2025-08-20 17:39:22.545 - DL_COMM - INFO - [SYSTEM] PMI_RANK                       = 0
2025-08-20 17:39:22.545 - DL_COMM - INFO - [SYSTEM] TORCH_CUDA_ARCH_LIST           = 8.0
2025-08-20 17:39:22.545 - DL_COMM - INFO - [SYSTEM] XLA_FLAGS                      = --xla_gpu_force_compilation_parallelism=1 --xla_gpu_cuda_data_dir=/soft/compilers/cudatoolkit/cuda-12.4.1/
2025-08-20 17:39:22.545 - DL_COMM - INFO - [SYSTEM] XLA_PYTHON_CLIENT_PREALLOCATE  = false
2025-08-20 17:39:22.545 - DL_COMM - INFO - [SYSTEM] ======================================================
2025-08-20 17:39:22.545 - DL_COMM - INFO - 
2025-08-20 17:39:22.560 - DL_COMM - INFO - 
2025-08-20 17:39:22.561 - DL_COMM - INFO - [CONFIG] Setup
2025-08-20 17:39:22.561 - DL_COMM - INFO - [CONFIG] ------------------------------------------------------
2025-08-20 17:39:22.561 - DL_COMM - INFO - [CONFIG] Task Name            : simple-allreduce
2025-08-20 17:39:22.561 - DL_COMM - INFO - [CONFIG] Framework            : pytorch
2025-08-20 17:39:22.561 - DL_COMM - INFO - [CONFIG] Backend              : nccl
2025-08-20 17:39:22.561 - DL_COMM - INFO - [CONFIG] Extended Logging     : False
2025-08-20 17:39:22.561 - DL_COMM - INFO - [CONFIG] Barrier Enabled      : True
2025-08-20 17:39:22.561 - DL_COMM - INFO - [CONFIG] World Size           : 8
2025-08-20 17:39:22.561 - DL_COMM - INFO - [CONFIG] ------------------------------------------------------
2025-08-20 17:39:22.561 - DL_COMM - INFO - 
2025-08-20 17:39:22.561 - DL_COMM - INFO - [CONFIG] Communication Group
2025-08-20 17:39:22.561 - DL_COMM - INFO - [CONFIG] ------------------------------------------------------
2025-08-20 17:39:22.561 - DL_COMM - INFO - [CONFIG] Mode                 : flatview
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] Topology             : 2 nodes x 4 devices
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] ------------------------------------------------------
2025-08-20 17:39:22.562 - DL_COMM - INFO - 
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] Communication Group Details
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] ------------------------------------------------------
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] Collective Name      : allreduce
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] Operation            : sum
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] Scale Up Algorithm   : default
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] Scale Out Algorithm  : default
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] Data Type            : float32
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] Element Count        : 25600
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] Buffer Size          : 100KB (102400 bytes)
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] Iterations           : 5
2025-08-20 17:39:22.562 - DL_COMM - INFO - [CONFIG] Verify Correctness   : True
2025-08-20 17:39:22.563 - DL_COMM - INFO - [CONFIG] ------------------------------------------------------
2025-08-20 17:39:22.563 - DL_COMM - INFO - 
2025-08-20 17:39:22.563 - DL_COMM - INFO - [COMM][CONFIG] Flatview: 2 nodes, 4 devices per node, Device IDs: [0, 1, 2, 3]
2025-08-20 17:39:22.563 - DL_COMM - INFO - 
2025-08-20 17:39:22.563 - DL_COMM - INFO - [COMM][GROUP CREATION] Flatview groups:
2025-08-20 17:39:22.563 - DL_COMM - INFO - [COMM][GROUP CREATION][Flatview] Ranks: [0, 1, 2, 3, 4, 5, 6, 7], Required Devices: [0, 1, 2, 3], Logging: rank 0
2025-08-20 17:39:23.495 - DL_COMM - OUTPUT - 
2025-08-20 17:39:23.496 - DL_COMM - OUTPUT - [MxM COMPUTE] Matrix multiplication compute completed.
2025-08-20 17:39:23.496 - DL_COMM - OUTPUT - 
2025-08-20 17:39:23.496 - DL_COMM - OUTPUT - 
2025-08-20 17:39:23.496 - DL_COMM - OUTPUT - [TIMERS - SETUP] ---------------------------------------------------------
2025-08-20 17:39:23.496 - DL_COMM - OUTPUT - [TIMERS][LOGGING RANK - 0] import time                         = 1.755297 s
2025-08-20 17:39:23.496 - DL_COMM - OUTPUT - [TIMERS][LOGGING RANK - 0] init time                           = 0.014180 s
2025-08-20 17:39:23.496 - DL_COMM - OUTPUT - [TIMERS][LOGGING RANK - 0] Group Creation (Flatview)           = 0.000433 s
2025-08-20 17:39:23.496 - DL_COMM - OUTPUT - [TIMERS][LOGGING RANK - 0] MxM Compute Time, m=1024            = 0.297626 s
2025-08-20 17:39:23.496 - DL_COMM - OUTPUT - [TIMERS - SETUP] ---------------------------------------------------------
2025-08-20 17:39:23.496 - DL_COMM - OUTPUT - 
2025-08-20 17:39:23.496 - DL_COMM - OUTPUT - [MPI] Launching profiling job
2025-08-20 17:39:23.497 - DL_COMM - INFO - 
2025-08-20 17:39:23.497 - DL_COMM - INFO -   [WARMUP] Running 2 warmup iterations...
2025-08-20 17:39:24.324 - DL_COMM - INFO -   [WARMUP] Warmup completed, starting timed iterations...
2025-08-20 17:39:24.325 - DL_COMM - INFO - 
2025-08-20 17:39:24.456 - DL_COMM - OUTPUT - 
2025-08-20 17:39:24.456 - DL_COMM - OUTPUT - [TIMERS] ---------------------------------------------------------
2025-08-20 17:39:24.456 - DL_COMM - OUTPUT - 
2025-08-20 17:39:24.456 - DL_COMM - INFO -   [TIMERS] [BARRIER ENABLED] Timing measurements used MPI barriers for synchronization
2025-08-20 17:39:24.456 - DL_COMM - OUTPUT - 
2025-08-20 17:39:24.456 - DL_COMM - OUTPUT - [TIMERS] ITERATION TABLE FOR ALLREDUCE (seconds):
2025-08-20 17:39:24.456 - DL_COMM - OUTPUT - Iteration        (Flatview)     
2025-08-20 17:39:24.456 - DL_COMM - OUTPUT -               LOGGING RANK - 0  
2025-08-20 17:39:24.456 - DL_COMM - OUTPUT - --------------------------------
2025-08-20 17:39:24.456 - DL_COMM - OUTPUT - 0                 0.000356      
2025-08-20 17:39:24.456 - DL_COMM - OUTPUT - 1                 0.000398      
2025-08-20 17:39:24.456 - DL_COMM - OUTPUT - 2                 0.000389      
2025-08-20 17:39:24.456 - DL_COMM - OUTPUT - 3                 0.000360      
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - 4                 0.000409      
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - --------------------------------
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - 
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - [TIMERS] ---------------------------------------------------------
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - 
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - [BANDWIDTH] -------------------------------------------
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - 
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - [BANDWIDTH] BANDWIDTH TABLE FOR ALLREDUCE (bytes/seconds):
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - Iteration        (Flatview)     
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT -               LOGGING RANK - 0  
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - --------------------------------
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - 0                2303082270     
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - 1                2059502274     
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - 2                2108136232     
2025-08-20 17:39:24.457 - DL_COMM - OUTPUT - 3                2273814706     
2025-08-20 17:39:24.458 - DL_COMM - OUTPUT - 4                2001919287     
2025-08-20 17:39:24.458 - DL_COMM - OUTPUT - --------------------------------
2025-08-20 17:39:24.458 - DL_COMM - OUTPUT - 
2025-08-20 17:39:24.458 - DL_COMM - OUTPUT - [BANDWIDTH] -------------------------------------------
2025-08-20 17:39:24.458 - DL_COMM - INFO - -------------------------------------------------------------------------
2025-08-20 17:39:24.458 - DL_COMM - INFO - [MPI] Job complete
2025-08-20 17:39:24.458 - DL_COMM - INFO - -------------------------------------------------------------------------
2025-08-20 17:39:24.458 - DL_COMM - INFO - -------------------------------------------------------------------------
2025-08-20 17:39:24.458 - DL_COMM - INFO - [EXIT] All Done.
2025-08-20 17:39:24.458 - DL_COMM - INFO - -------------------------------------------------------------------------
