[2025-08-20 16:32:53,880][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:32:53,883][DL_COMM][INFO] - [CONFIG] Loading schema and validating user YAML
[2025-08-20 16:32:53,883][DL_COMM][INFO] - [DEBUG] Current working directory: /lus/flare/projects/datascience_collab/mcim/workspace/gpu-comm/DLcomm_benchmark/examples
[2025-08-20 16:32:53,883][DL_COMM][INFO] - [DEBUG] Script location: /lus/flare/projects/datascience_collab/mcim/workspace/gpu-comm/DLcomm_benchmark/dl_comm
[2025-08-20 16:32:53,883][DL_COMM][INFO] - [DEBUG] Tasks to run: ['SP-allgather', 'SP-reducescatter', 'grad-sync']
[2025-08-20 16:32:53,883][DL_COMM][INFO] - [DEBUG] Config loaded successfully
[2025-08-20 16:32:57,592][DL_COMM][INFO] - 
[2025-08-20 16:32:57,592][DL_COMM][INFO] - [SYSTEM] Collecting environment information...
[2025-08-20 16:32:57,592][DL_COMM][INFO] - [SYSTEM] ======================================================
[2025-08-20 16:32:57,592][DL_COMM][INFO] - [SYSTEM] PyTorch version: 2.5.1+cxx11.abi
[2025-08-20 16:32:57,592][DL_COMM][INFO] - [SYSTEM] Is CUDA available: False
[2025-08-20 16:32:57,592][DL_COMM][INFO] - [SYSTEM] CUDA runtime version: N/A
[2025-08-20 16:32:57,592][DL_COMM][INFO] - [SYSTEM] GPU models and configuration: N/A
[2025-08-20 16:32:57,606][DL_COMM][INFO] - [SYSTEM] Is XPU available: True
[2025-08-20 16:32:57,606][DL_COMM][INFO] - [SYSTEM] XPU device count: 12
[2025-08-20 16:32:57,606][DL_COMM][INFO] - 
[2025-08-20 16:32:57,611][DL_COMM][INFO] - [SYSTEM] OS: Linux-5.14.21-150400.24.55-default-x86_64-with-glibc2.31
[2025-08-20 16:32:57,615][DL_COMM][INFO] - [SYSTEM] GCC version: gcc (Spack GCC) 13.3.0
[2025-08-20 16:32:57,615][DL_COMM][INFO] - 
[2025-08-20 16:32:57,615][DL_COMM][INFO] - [SYSTEM] Python version: 3.10.14 | packaged by conda-forge | (main, Mar 20 2024, 12:45:18) [GCC 12.3.0]
[2025-08-20 16:32:57,615][DL_COMM][INFO] - [SYSTEM] Python platform: Linux-5.14.21-150400.24.55-default-x86_64-with-glibc2.31
[2025-08-20 16:32:57,616][DL_COMM][INFO] - 
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] Distributed Backend Availability:
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] NCCL backend available: False
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] MPI backend available: False
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] XCCL backend available: Unknown/Error
[2025-08-20 16:32:57,616][DL_COMM][INFO] - 
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] Versions of relevant libraries:
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] numpy: 1.26.4
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] mpi4py: 3.1.6
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] hydra-core: 1.3.2
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] omegaconf: 2.3.0
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] oneccl_bindings_for_pytorch: 2.5.0+xpu
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] intel_extension_for_pytorch: 2.5.10+xpu
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] NCCL version: Not available
[2025-08-20 16:32:57,616][DL_COMM][INFO] - 
[2025-08-20 16:32:57,616][DL_COMM][INFO] - [SYSTEM] Relevant Environment Variables:
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] CCL_ATL_SHM                    = 0
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] CCL_ATL_TRANSPORT              = mpi
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] CCL_CONFIGURATION              = cpu_gpu_dpcpp
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] CCL_CONFIGURATION_PATH         = 
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] CCL_ENABLE_AUTO_CACHE          = 0
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] CCL_KVS_CONNECTION_TIMEOUT     = 600
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] CCL_KVS_MODE                   = mpi
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] CCL_OP_SYNC                    = 1
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] CCL_PROCESS_LAUNCHER           = pmix
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] CCL_ROOT                       = /opt/aurora/24.347.0/oneapi/ccl/latest
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] FI_CXI_CQ_FILL_PERCENT         = 30
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] FI_CXI_DEFAULT_CQ_SIZE         = 1048576
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] FI_CXI_OFLOW_BUF_SIZE          = 8388608
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] FI_CXI_RX_MATCH_MODE           = hybrid
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] FI_MR_CACHE_MONITOR            = userfaultfd
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] FI_PROVIDER                    = cxi,tcp;ofi_rxm
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] MASTER_ADDR                    = x4304c0s1b0n0
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] MASTER_PORT                    = 2268
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] MPIR_CVAR_CH4_OFI_MAX_NICS     = 1
[2025-08-20 16:32:57,617][DL_COMM][INFO] - [SYSTEM] PALS_LOCAL_RANKID              = 0
[2025-08-20 16:32:57,618][DL_COMM][INFO] - [SYSTEM] PALS_RANKID                    = 0
[2025-08-20 16:32:57,618][DL_COMM][INFO] - [SYSTEM] PMIX_RANK                      = 0
[2025-08-20 16:32:57,618][DL_COMM][INFO] - [SYSTEM] __LMOD_STACK_FI_PROVIDER       = Y3hpLHRjcDtvZmlfcnht
[2025-08-20 16:32:57,618][DL_COMM][INFO] - [SYSTEM] __LMOD_STACK_MPIR_CVAR_CH4_OFI_MAX_NICS = MQ==
[2025-08-20 16:32:57,618][DL_COMM][INFO] - [SYSTEM] ======================================================
[2025-08-20 16:32:57,618][DL_COMM][INFO] - 
[2025-08-20 16:32:57,742][DL_COMM][INFO] - 
[2025-08-20 16:32:57,742][DL_COMM][INFO] - ================================================================================
[2025-08-20 16:32:57,742][DL_COMM][INFO] - [TASK 1/3] ==================== SP-ALLGATHER ====================
[2025-08-20 16:32:57,742][DL_COMM][INFO] - ================================================================================
[2025-08-20 16:32:57,742][DL_COMM][INFO] - 
[2025-08-20 16:32:57,743][DL_COMM][WARNING] - [VALIDATION] Cannot check CCL/XCCL availability (API not available)
[2025-08-20 16:32:57,743][DL_COMM][INFO] - 
[2025-08-20 16:32:57,743][DL_COMM][INFO] - [CONFIG] Setup
[2025-08-20 16:32:57,743][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:32:57,743][DL_COMM][INFO] - [CONFIG] Task Name            : SP-allgather
[2025-08-20 16:32:57,743][DL_COMM][INFO] - [CONFIG] Framework            : pytorch
[2025-08-20 16:32:57,743][DL_COMM][INFO] - [CONFIG] Backend              : ccl
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Extended Logging     : False
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Barrier Enabled      : True
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] World Size           : 8
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:32:57,744][DL_COMM][INFO] - 
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Communication Group
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Mode                 : within_node
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Topology             : 2 nodes x 4 devices
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:32:57,744][DL_COMM][INFO] - 
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Communication Group Details
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Collective Name      : allgather
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Operation            : N/A
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Scale Up Algorithm   : topo
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Scale Out Algorithm  : topo
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Data Type            : bfloat16
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Element Count        : 1024
[2025-08-20 16:32:57,744][DL_COMM][INFO] - [CONFIG] Count                : 1024 elements (2048 bytes)
[2025-08-20 16:32:57,745][DL_COMM][INFO] - [CONFIG] Iterations           : 5
[2025-08-20 16:32:57,745][DL_COMM][INFO] - [CONFIG] Verify Correctness   : True
[2025-08-20 16:32:57,745][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:32:57,745][DL_COMM][INFO] - 
[2025-08-20 16:32:57,745][DL_COMM][INFO] - [COMM][CONFIG] Setting up communication groups for mode: Within
[2025-08-20 16:32:57,745][DL_COMM][INFO] - [COMM][CONFIG] Within-node: 4 devices per node, Device IDs: [0, 1, 2, 3]
[2025-08-20 16:32:57,745][DL_COMM][INFO] - [COMM][GROUP CREATION] Within-node groups:
[2025-08-20 16:32:57,745][DL_COMM][INFO] - 
[2025-08-20 16:32:57,745][DL_COMM][INFO] - [COMM][GROUP CREATION][Within Group-0] Ranks: [0, 1, 2, 3], Required Devices: [0, 1, 2, 3], Logging: rank 0
[2025-08-20 16:32:57,745][DL_COMM][INFO] - [COMM][GROUP CREATION][Within Group-1] Ranks: [4, 5, 6, 7], Required Devices: [0, 1, 2, 3], Logging: rank 4
[2025-08-20 16:32:57,745][DL_COMM][INFO] - [COMM][GROUP CREATION] Created 2 within-node groups
[2025-08-20 16:32:57,746][DL_COMM][INFO] - 
[2025-08-20 16:32:58,116][DL_COMM][OUTPUT] - 
[2025-08-20 16:32:58,116][DL_COMM][OUTPUT] - [MxM COMPUTE] Matrix multiplication compute completed.
[2025-08-20 16:32:58,116][DL_COMM][OUTPUT] - 
[2025-08-20 16:32:58,144][DL_COMM][OUTPUT] - 
[2025-08-20 16:32:58,144][DL_COMM][OUTPUT] - [TIMERS - SETUP] ---------------------------------------------------------
[2025-08-20 16:32:58,144][DL_COMM][OUTPUT] - [TIMERS][LOGGING RANK - 0] import time                         = 3.708590 s
[2025-08-20 16:32:58,144][DL_COMM][OUTPUT] - [TIMERS][LOGGING RANK - 0] init time                           = 0.012609 s
[2025-08-20 16:32:58,144][DL_COMM][OUTPUT] - [TIMERS][LOGGING RANK - 0] Group Creation (Within)             = 0.000495 s
[2025-08-20 16:32:58,144][DL_COMM][OUTPUT] - [TIMERS][LOGGING RANK - 0] Host to Device Transfer Time        = 0.002184 s
[2025-08-20 16:32:58,144][DL_COMM][OUTPUT] - [TIMERS][LOGGING RANK - 0] MxM Compute Time, m=1024            = 0.319899 s
[2025-08-20 16:32:58,144][DL_COMM][OUTPUT] - [TIMERS - SETUP] ---------------------------------------------------------
[2025-08-20 16:32:58,144][DL_COMM][OUTPUT] - 
[2025-08-20 16:32:58,144][DL_COMM][OUTPUT] - [MPI] Launching profiling job
[2025-08-20 16:32:58,144][DL_COMM][INFO] - 
[2025-08-20 16:32:58,144][DL_COMM][INFO] -   [WARMUP] Running 2 warmup iterations...
2025:08:20-16:32:58:(78206) |CCL_WARN| value of CCL_KVS_MODE changed to be mpi (default:pmi)
2025:08:20-16:32:58:(78206) |CCL_WARN| value of CCL_KVS_CONNECTION_TIMEOUT changed to be 600 (default:120)
2025:08:20-16:32:58:(78206) |CCL_WARN| value of CCL_ENABLE_AUTO_CACHE changed to be 0 (default:1)
2025:08:20-16:32:58:(78206) |CCL_WARN| value of CCL_ALLGATHER changed to be topo (default:)
2025:08:20-16:32:58:(78206) |CCL_WARN| value of CCL_ALLREDUCE changed to be topo (default:)
2025:08:20-16:32:58:(78206) |CCL_WARN| value of CCL_REDUCE_SCATTER changed to be topo (default:)
2025:08:20-16:32:58:(78206) |CCL_WARN| value of CCL_ALLGATHER_SCALEOUT changed to be topo (default:)
2025:08:20-16:32:58:(78206) |CCL_WARN| value of CCL_ALLREDUCE_SCALEOUT changed to be topo (default:)
2025:08:20-16:32:58:(78206) |CCL_WARN| value of CCL_REDUCE_SCATTER_SCALEOUT changed to be topo (default:)
2025:08:20-16:32:58:(78206) |CCL_WARN| value of CCL_OP_SYNC changed to be 1 (default:0)
2025:08:20-16:32:58:(78206) |CCL_WARN| value of CCL_PROCESS_LAUNCHER changed to be pmix (default:hydra)
[2025-08-20 16:33:07,585][DL_COMM][INFO] -   [WARMUP] Warmup completed, starting timed iterations...
[2025-08-20 16:33:07,589][DL_COMM][INFO] - 
[2025-08-20 16:33:07,728][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,728][DL_COMM][OUTPUT] - [TIMERS] ---------------------------------------------------------
[2025-08-20 16:33:07,728][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,728][DL_COMM][INFO] -   [TIMERS] [BARRIER ENABLED] Timing measurements used MPI barriers for synchronization
[2025-08-20 16:33:07,728][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,728][DL_COMM][OUTPUT] - [TIMERS] ITERATION TABLE FOR ALLGATHER (seconds):
[2025-08-20 16:33:07,728][DL_COMM][OUTPUT] - Iteration     (Within-Group-0)    (Within-Group-1)  
[2025-08-20 16:33:07,728][DL_COMM][OUTPUT] -               LOGGING RANK - 0    LOGGING RANK - 4  
[2025-08-20 16:33:07,728][DL_COMM][OUTPUT] - ----------------------------------------------------
[2025-08-20 16:33:07,728][DL_COMM][OUTPUT] - 0                 0.000445            0.000366      
[2025-08-20 16:33:07,728][DL_COMM][OUTPUT] - 1                 0.000480            0.000489      
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - 2                 0.000341            0.000322      
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - 3                 0.000313            0.000297      
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - 4                 0.000325            0.000303      
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - ----------------------------------------------------
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - [TIMERS] ---------------------------------------------------------
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - [BANDWIDTH] -------------------------------------------
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - [BANDWIDTH] BANDWIDTH TABLE FOR ALLGATHER (bytes/seconds):
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - Iteration     (Within-Group-0)    (Within-Group-1)  
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] -               LOGGING RANK - 0    LOGGING RANK - 4  
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - ----------------------------------------------------
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - 0                 18391011            22358079      
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - 1                 17057357            16752078      
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - 2                 24037844            25460047      
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - 3                 26184737            27612522      
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - 4                 25181518            26993188      
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - ----------------------------------------------------
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,729][DL_COMM][OUTPUT] - [BANDWIDTH] -------------------------------------------
[2025-08-20 16:33:07,729][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:33:07,729][DL_COMM][INFO] - [MPI] Job complete
[2025-08-20 16:33:07,729][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:33:07,730][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:33:07,730][DL_COMM][INFO] - [EXIT] All Done.
[2025-08-20 16:33:07,730][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:33:07,730][DL_COMM][INFO] - 
[2025-08-20 16:33:07,730][DL_COMM][INFO] - ================================================================================
[2025-08-20 16:33:07,730][DL_COMM][INFO] - [TASK 2/3] ==================== SP-REDUCESCATTER ====================
[2025-08-20 16:33:07,730][DL_COMM][INFO] - ================================================================================
[2025-08-20 16:33:07,730][DL_COMM][INFO] - 
[2025-08-20 16:33:07,730][DL_COMM][INFO] - 
[2025-08-20 16:33:07,730][DL_COMM][INFO] - [CONFIG] Setup
[2025-08-20 16:33:07,730][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:33:07,730][DL_COMM][INFO] - [CONFIG] Task Name            : SP-reducescatter
[2025-08-20 16:33:07,730][DL_COMM][INFO] - [CONFIG] Framework            : pytorch
[2025-08-20 16:33:07,730][DL_COMM][INFO] - [CONFIG] Backend              : ccl
[2025-08-20 16:33:07,730][DL_COMM][INFO] - [CONFIG] Extended Logging     : False
[2025-08-20 16:33:07,730][DL_COMM][INFO] - [CONFIG] Barrier Enabled      : True
[2025-08-20 16:33:07,730][DL_COMM][INFO] - [CONFIG] World Size           : 8
[2025-08-20 16:33:07,730][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:33:07,730][DL_COMM][INFO] - 
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Communication Group
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Mode                 : within_node
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Topology             : 2 nodes x 4 devices
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:33:07,731][DL_COMM][INFO] - 
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Communication Group Details
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Collective Name      : reducescatter
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Operation            : min
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Scale Up Algorithm   : topo
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Scale Out Algorithm  : topo
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Data Type            : bfloat16
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Element Count        : 1024
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Count                : 1024 elements (2048 bytes)
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Iterations           : 5
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] Verify Correctness   : True
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:33:07,731][DL_COMM][INFO] - 
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [COMM][CONFIG] Setting up communication groups for mode: Within
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [COMM][CONFIG] Within-node: 4 devices per node, Device IDs: [0, 1, 2, 3]
[2025-08-20 16:33:07,731][DL_COMM][INFO] - [COMM][GROUP CREATION] Within-node groups:
[2025-08-20 16:33:07,731][DL_COMM][INFO] - 
[2025-08-20 16:33:07,732][DL_COMM][INFO] - [COMM][GROUP CREATION][Within Group-0] Ranks: [0, 1, 2, 3], Required Devices: [0, 1, 2, 3], Logging: rank 0
[2025-08-20 16:33:07,732][DL_COMM][INFO] - [COMM][GROUP CREATION][Within Group-1] Ranks: [4, 5, 6, 7], Required Devices: [0, 1, 2, 3], Logging: rank 4
[2025-08-20 16:33:07,732][DL_COMM][INFO] - [COMM][GROUP CREATION] Created 2 within-node groups
[2025-08-20 16:33:07,732][DL_COMM][INFO] - 
[2025-08-20 16:33:07,732][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,732][DL_COMM][OUTPUT] - [MxM COMPUTE] Matrix multiplication compute completed.
[2025-08-20 16:33:07,732][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,751][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,751][DL_COMM][OUTPUT] - [TIMERS - SETUP] ---------------------------------------------------------
[2025-08-20 16:33:07,751][DL_COMM][OUTPUT] - [TIMERS][LOGGING RANK - 0] Group Creation (Within)             = 0.000373 s
[2025-08-20 16:33:07,751][DL_COMM][OUTPUT] - [TIMERS][LOGGING RANK - 0] Host to Device Transfer Time        = 0.000052 s
[2025-08-20 16:33:07,751][DL_COMM][OUTPUT] - [TIMERS][LOGGING RANK - 0] MxM Compute Time, m=1024            = 0.000443 s
[2025-08-20 16:33:07,751][DL_COMM][OUTPUT] - [TIMERS - SETUP] ---------------------------------------------------------
[2025-08-20 16:33:07,751][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,751][DL_COMM][OUTPUT] - [MPI] Launching profiling job
[2025-08-20 16:33:07,751][DL_COMM][INFO] - 
[2025-08-20 16:33:07,751][DL_COMM][INFO] -   [WARMUP] Running 2 warmup iterations...
[2025-08-20 16:33:07,833][DL_COMM][INFO] -   [WARMUP] Warmup completed, starting timed iterations...
[2025-08-20 16:33:07,833][DL_COMM][INFO] - 
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - [TIMERS] ---------------------------------------------------------
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,840][DL_COMM][INFO] -   [TIMERS] [BARRIER ENABLED] Timing measurements used MPI barriers for synchronization
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - [TIMERS] ITERATION TABLE FOR REDUCESCATTER (seconds):
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - Iteration     (Within-Group-0)    (Within-Group-1)  
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] -               LOGGING RANK - 0    LOGGING RANK - 4  
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - ----------------------------------------------------
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - 0                 0.000447            0.000393      
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - 1                 0.000406            0.000395      
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - 2                 0.000391            0.000384      
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - 3                 0.000370            0.000375      
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - 4                 0.000365            0.000374      
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - ----------------------------------------------------
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - [TIMERS] ---------------------------------------------------------
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,840][DL_COMM][OUTPUT] - [BANDWIDTH] -------------------------------------------
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] - [BANDWIDTH] BANDWIDTH TABLE FOR REDUCESCATTER (bytes/seconds):
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] - Iteration     (Within-Group-0)    (Within-Group-1)  
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] -               LOGGING RANK - 0    LOGGING RANK - 4  
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] - ----------------------------------------------------
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] - 0                 18336755            20835136      
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] - 1                 20187087            20760158      
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] - 2                 20934113            21345453      
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] - 3                 22120331            21831944      
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] - 4                 22440394            21923967      
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] - ----------------------------------------------------
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,841][DL_COMM][OUTPUT] - [BANDWIDTH] -------------------------------------------
[2025-08-20 16:33:07,841][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:33:07,841][DL_COMM][INFO] - [MPI] Job complete
[2025-08-20 16:33:07,841][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:33:07,841][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:33:07,841][DL_COMM][INFO] - [EXIT] All Done.
[2025-08-20 16:33:07,841][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:33:07,841][DL_COMM][INFO] - 
[2025-08-20 16:33:07,841][DL_COMM][INFO] - ================================================================================
[2025-08-20 16:33:07,841][DL_COMM][INFO] - [TASK 3/3] ==================== GRAD-SYNC ====================
[2025-08-20 16:33:07,841][DL_COMM][INFO] - ================================================================================
[2025-08-20 16:33:07,841][DL_COMM][INFO] - 
[2025-08-20 16:33:07,842][DL_COMM][INFO] - 
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Setup
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Task Name            : grad-sync
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Framework            : pytorch
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Backend              : ccl
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Extended Logging     : False
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Barrier Enabled      : True
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] World Size           : 8
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:33:07,842][DL_COMM][INFO] - 
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Communication Group
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Mode                 : across_node
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Topology             : 2 nodes x 4 devices
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:33:07,842][DL_COMM][INFO] - 
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Communication Group Details
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Collective Name      : allreduce
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Operation            : min
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Scale Up Algorithm   : topo
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Scale Out Algorithm  : topo
[2025-08-20 16:33:07,842][DL_COMM][INFO] - [CONFIG] Data Type            : bfloat16
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [CONFIG] Element Count        : 512
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [CONFIG] Buffer Size          : 1KB (1024 bytes)
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [CONFIG] Iterations           : 5
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [CONFIG] Verify Correctness   : True
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [CONFIG] ------------------------------------------------------
[2025-08-20 16:33:07,843][DL_COMM][INFO] - 
[2025-08-20 16:33:07,843][DL_COMM][INFO] - 
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [COMM][CONFIG] Setting up communication groups for mode: Across
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [COMM][CONFIG] Across-node: 2 nodes, 4 devices per node, Device IDs: [0, 1, 2, 3]
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [COMM][GROUP CREATION] Across-node groups:
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [COMM][GROUP CREATION][Across Group-0] Ranks: [0, 4], Device ID: 0, Logging: rank 0
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [COMM][GROUP CREATION][Across Group-1] Ranks: [1, 5], Device ID: 1, Logging: rank 1
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [COMM][GROUP CREATION][Across Group-2] Ranks: [2, 6], Device ID: 2, Logging: rank 2
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [COMM][GROUP CREATION][Across Group-3] Ranks: [3, 7], Device ID: 3, Logging: rank 3
[2025-08-20 16:33:07,843][DL_COMM][INFO] - [COMM][GROUP CREATION] Created 4 across-node groups
[2025-08-20 16:33:07,843][DL_COMM][INFO] - 
[2025-08-20 16:33:07,844][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,844][DL_COMM][OUTPUT] - [MxM COMPUTE] Matrix multiplication compute completed.
[2025-08-20 16:33:07,844][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,862][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,862][DL_COMM][OUTPUT] - [TIMERS - SETUP] ---------------------------------------------------------
[2025-08-20 16:33:07,862][DL_COMM][OUTPUT] - [TIMERS][LOGGING RANK - 0] Group Creation (Across)             = 0.000414 s
[2025-08-20 16:33:07,862][DL_COMM][OUTPUT] - [TIMERS][LOGGING RANK - 0] Host to Device Transfer Time        = 0.000195 s
[2025-08-20 16:33:07,862][DL_COMM][OUTPUT] - [TIMERS][LOGGING RANK - 0] MxM Compute Time, m=1024            = 0.000341 s
[2025-08-20 16:33:07,862][DL_COMM][OUTPUT] - [TIMERS - SETUP] ---------------------------------------------------------
[2025-08-20 16:33:07,862][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,862][DL_COMM][OUTPUT] - [MPI] Launching profiling job
[2025-08-20 16:33:07,862][DL_COMM][INFO] - 
[2025-08-20 16:33:07,863][DL_COMM][INFO] -   [WARMUP] Running 2 warmup iterations...
[2025-08-20 16:33:07,870][DL_COMM][INFO] -   [WARMUP] Warmup completed, starting timed iterations...
[2025-08-20 16:33:07,870][DL_COMM][INFO] - 
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - [TIMERS] ---------------------------------------------------------
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,877][DL_COMM][INFO] -   [TIMERS] [BARRIER ENABLED] Timing measurements used MPI barriers for synchronization
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - [TIMERS] ITERATION TABLE FOR ALLREDUCE (seconds):
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - Iteration     (Across-Group-0)    (Across-Group-1)    (Across-Group-2)    (Across-Group-3)  
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] -               LOGGING RANK - 0    LOGGING RANK - 1    LOGGING RANK - 2    LOGGING RANK - 3  
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - --------------------------------------------------------------------------------------------
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - 0                 0.000275            0.000260            0.000259            0.000181      
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - 1                 0.000257            0.000252            0.000257            0.000188      
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - 2                 0.000263            0.000255            0.000265            0.000187      
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - 3                 0.000245            0.000241            0.000248            0.000183      
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - 4                 0.000237            0.000253            0.001162            0.000186      
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - --------------------------------------------------------------------------------------------
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - [TIMERS] ---------------------------------------------------------
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,877][DL_COMM][OUTPUT] - [BANDWIDTH] -------------------------------------------
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] - [BANDWIDTH] BANDWIDTH TABLE FOR ALLREDUCE (bytes/seconds):
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] - Iteration     (Across-Group-0)    (Across-Group-1)    (Across-Group-2)    (Across-Group-3)  
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] -               LOGGING RANK - 0    LOGGING RANK - 1    LOGGING RANK - 2    LOGGING RANK - 3  
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] - --------------------------------------------------------------------------------------------
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] - 0                 14909671            15752573            15796130            22619086      
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] - 1                 15942395            16251258            15947486            21793958      
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] - 2                 15585226            16033823            15432669            21893906      
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] - 3                 16731756            17027293            16530393            22427863      
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] - 4                 17308555            16219662            3525072             22041058      
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] - --------------------------------------------------------------------------------------------
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] - 
[2025-08-20 16:33:07,878][DL_COMM][OUTPUT] - [BANDWIDTH] -------------------------------------------
[2025-08-20 16:33:07,878][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:33:07,878][DL_COMM][INFO] - [MPI] Job complete
[2025-08-20 16:33:07,878][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:33:07,878][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:33:07,878][DL_COMM][INFO] - [EXIT] All Done.
[2025-08-20 16:33:07,878][DL_COMM][INFO] - -------------------------------------------------------------------------
[2025-08-20 16:33:07,878][DL_COMM][INFO] - 
[2025-08-20 16:33:07,878][DL_COMM][INFO] - ================================================================================
[2025-08-20 16:33:07,878][DL_COMM][INFO] - [FINAL] All 3 tasks completed successfully!
[2025-08-20 16:33:07,878][DL_COMM][INFO] - ================================================================================
